好，我们把 **第 3 周（Day 15–21）** 做成一份
👉 **“照着做就能跑”的训练手册**。
每天都有：**目标 → 必做 → 示例 → 验收点**，不留空白 🧩

---

# 🟠 第 3 周：CI/CD 概念 + YAML（Day 15–21）【详细版】

> 前提：你已经有一个 GitLab 或 GitHub 仓库
> 文件名：
>
> * GitLab：`.gitlab-ci.yml`
> * GitHub：`.github/workflows/ci.yml`

（以下以 **GitLab CI** 为主，GitHub Actions 我会在关键点标注对照）

---

## 🟢 Day 15：CI / CD 思维模型（不是敲代码）

### 今日目标

* 分清 CI 和 CD
* 知道 pipeline 什么时候触发

---

### 必须搞懂的 3 个问题

#### 1️⃣ CI 在干嘛？

* 代码一提交
* 自动执行：

  * lint
  * test
  * build

👉 **目的是尽早发现问题**

---

#### 2️⃣ CD 在干嘛？

* CI 通过后
* 自动：

  * 打包
  * 部署
  * 发布

👉 **目的是稳定交付**

---

#### 3️⃣ Pipeline 什么时候跑？

* git push
* merge request
* tag

📌 记住一句：

> **pipeline 是事件驱动的**

---

### 验收点

* 你能回答：

  > “为什么 CI 不一定要部署？”

---

## 🟢 Day 16：Pipeline / Stage / Job（骨架）

### 今日目标

* 理解 YAML 结构
* 知道执行顺序

---

### YAML 最小骨架

```yaml
stages:
  - test
  - build
```

### 添加第一个 job

```yaml
test-job:
  stage: test
  script:
    - echo "running test"
```

---

### 执行逻辑（一定要理解）

```
pipeline
 ├─ stage: test
 │   └─ job: test-job
 └─ stage: build
```

* stage 严格顺序
* stage 内 job 并行

---

### 验收点

* 你能解释：

  > “为什么同一个 stage 可以放多个 job？”

---

## 🟡 Day 17：最小可跑流水线（一定要跑起来）

### 今日目标

* 第一次成功跑 pipeline

---

### 实操步骤

1️⃣ 创建 `.gitlab-ci.yml`

```yaml
stages:
  - test

hello-ci:
  stage: test
  script:
    - echo "Hello CI"
```

2️⃣ git push

3️⃣ 打开 CI 页面，看 pipeline

---

### 必须做的 3 件事

* 点开 pipeline
* 点开 job
* 看完整日志

---

### 验收点

* pipeline 是绿色
* 你能在日志里找到 `Hello CI`

---

## 🟡 Day 18：失败是老师（故意搞砸）

### 今日目标

* 学会看失败原因
* 不慌

---

### 修改 job

```yaml
fail-job:
  stage: test
  script:
    - echo "this will fail"
    - exit 1
```

---

### 你要观察

* pipeline 状态：❌
* job 停在哪一行
* 错误信息是什么

---

### 验收点

* 你能说清楚：

  > “pipeline 为什么失败？”

---

## 🟠 Day 19：变量（CI 的血液）

### 今日目标

* 不写死配置
* 知道变量作用域

---

### 定义变量

```yaml
variables:
  APP_NAME: demo-app
```

### 使用变量

```yaml
script:
  - echo $APP_NAME
```

---

### 变量级别

* 全局 variables
* job 内 variables
* CI 平台内置变量（如 commit id）

---

### 验收点

* 你能解释：

  > “为什么密码不能写在 YAML 里？”

---

## 🔵 Day 20：多 Stage + 依赖关系

### 今日目标

* 理解流水线“闸门”

---

### 示例

```yaml
stages:
  - test
  - build

test-job:
  stage: test
  script:
    - echo test

build-job:
  stage: build
  script:
    - echo build
```

---

### 行为观察

* test 失败 → build 不执行
* test 成功 → build 自动开始

---

### 验收点

* 你能画出执行顺序

---

## 🔵 Day 21：复盘 + 口述（非常重要）

### 今日目标

* 能“讲” CI/CD

---

### 你必须能口述：

1️⃣ pipeline 怎么触发
2️⃣ stage 为什么要分
3️⃣ job 失败会发生什么
4️⃣ 日志去哪看

---

### 终极验收

> 给你一份 YAML，你能不用电脑讲执行流程

---

## 📌 本周你已经掌握的能力

✅ 看懂 CI/CD YAML
✅ 写最小流水线
✅ 定位失败原因
✅ 不再害怕红色 pipeline

---

## 🧠 给你一句压轴记忆钩子

> **YAML 不是代码，是流程说明书**

---

## 下周预告（第 4 周）

你将把 CI 和 **Docker / Kubernetes** 接上，
从“会跑”进化到“能交付”。

如果你愿意，我可以下一步直接给你：

* 一套 **每天 30 分钟的 CI 排错练习**
* 或把 **GitHub Actions 版本完整对照写给你**
